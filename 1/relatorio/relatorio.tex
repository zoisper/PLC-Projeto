
\documentclass[11pt,a4paper]{report}%especifica o tipo de documento que tenciona escrever: carta, artigo, relatório... neste caso é um relatório
% [11pt,a4paper] Define o tamanho principal das letras do documento. caso não especifique uma delas, é assumido 10pt
% a4paper -- Define o tamanho do papel.

\usepackage[portuges]{babel}%Babel -- irá activar automaticamente as regras apropriadas de hifenização para a língua todo o
                                   %-- o texto gerado é automaticamente traduzido para Português.
                                   %  Por exemplo, “chapter” irá passar a “capítulo”, “table of contents” a “conteúdo”.
                                   % portuges -- específica para o Português.
\usepackage[utf8]{inputenc} % define o encoding usado texto fonte (input)--usual "utf8" ou "latin1

\usepackage{graphicx} %permite incluir graficos, tabelas, figuras
\usepackage{url} % para utilizar o comando \url{}
\usepackage{enumerate} %permite escolher, nas listas enumeradas, se os iems sao marcados com letras ou numeros-romanos em vez de numeracao normal

%\usepackage{apalike} % gerar biliografia no estilo 'named' (apalike)

\usepackage{color} % Para escrever em cores

\usepackage{multirow} %tabelas com multilinhas
\usepackage{array} %formatação especial de tabelas em array

\usepackage[pdftex]{hyperref} % transformar as referências internas do seu documento em hiper-ligações.

%Exemplos de fontes -- nao e vulgar mudar o tipo de fonte
%\usepackage{tgbonum} % Fonte de letra: TEX Gyre Bonum
%\usepackage{lmodern} % Fonte de letra: Latin Modern Sans Serif
%\usepackage{helvet}  % Fonte de letra: Helvetica
%\usepackage{charter} % Fonte de letra:Charter

\definecolor{saddlebrown}{rgb}{0.55, 0.27, 0.07} % para definir uma nova cor, neste caso 'saddlebrown'

\usepackage{listings}  % para utilizar blocos de texto verbatim no estilo 'listings'
%paramerização mais vulgar dos blocos LISTING - GENERAL
\lstset{
	basicstyle=\small, %o tamanho das fontes que são usadas para o código
	numbers=left, % onde colocar a numeração da linha
	numberstyle=\tiny, %o tamanho das fontes que são usadas para a numeração da linha
	numbersep=5pt, %distancia entre a numeração da linha e o codigo
	breaklines=true, %define quebra automática de linha
    frame=tB,  % caixa a volta do codigo
	mathescape=true, %habilita o modo matemático
	escapeinside={(*@}{@*)} % se escrever isto  aceita tudo o que esta dentro das marcas e nao altera
}
%
%\lstset{ %
%	language=Java,							% choose the language of the code
%	basicstyle=\ttfamily\footnotesize,		% the size of the fonts that are used for the code
%	keywordstyle=\bfseries,					% set the keyword style
%	%numbers=left,							% where to put the line-numbers
%	numberstyle=\scriptsize,				% the size of the fonts that are used for the line-numbers
%	stepnumber=2,							% the step between two line-numbers. If it's 1 each line
%											% will be numbered
%	numbersep=5pt,							% how far the line-numbers are from the code
%	backgroundcolor=\color{white},			% choose the background color. You must add \usepackage{color}
%	showspaces=false,						% show spaces adding particular underscores
%	showstringspaces=false,					% underline spaces within strings
%	showtabs=false,							% show tabs within strings adding particular underscores
%	frame=none,								% adds a frame around the code
%	%abovecaptionskip=-.8em,
%	%belowcaptionskip=.7em,
%	tabsize=2,								% sets default tabsize to 2 spaces
%	captionpos=b,							% sets the caption-position to bottom
%	breaklines=true,						% sets automatic line breaking
%	breakatwhitespace=false,				% sets if automatic breaks should only happen at whitespace
%	title=\lstname,							% show the filename of files included with \lstinputlisting;
%											% also try caption instead of title
%	escapeinside={\%*}{*)},					% if you want to add a comment within your code
%	morekeywords={*,...}					% if you want to add more keywords to the set
%}

\usepackage{xspace} % deteta se a seguir a palavra tem uma palavra ou um sinal de pontuaçao se tiver uma palavra da espaço, se for um sinal de pontuaçao nao da espaço

\parindent=0pt %espaço a deixar para fazer a  indentação da primeira linha após um parágrafo
\parskip=2pt % espaço entre o parágrafo e o texto anterior

\setlength{\oddsidemargin}{-1cm} %espaço entre o texto e a margem
\setlength{\textwidth}{18cm} %Comprimento do texto na pagina
\setlength{\headsep}{-1cm} %espaço entre o texto e o cabeçalho
\setlength{\textheight}{23cm} %altura do texto na pagina

% comando '\def' usado para definir abreviatura (macros)
% o primeiro argumento é o nome do novo comando e o segundo entre chavetas é o texto original, ou sequência de controle, para que expande
\def\darius{\textsf{Darius}\xspace}
\def\antlr{\texttt{AnTLR}\xspace}
\def\pe{\emph{Publicação Eletrónica}\xspace}
\def\titulo#1{\section{#1}}    %no corpo do documento usa-se na forma '\titulo{MEU TITULO}'
\def\super#1{{\em Supervisor: #1}\\ }
\def\area#1{{\em \'{A}rea: #1}\\[0.2cm]}
\def\resumo{\underline{Resumo}:\\ }

%\input{LPgeneralDefintions} %permite ler de um ficheiro de texto externo mais definições

\title{Processamento de Linguaguens e Compiladores (3º ano LCC)\\
       \textbf{Trabalho Prático 1}\\ Relatório de Desenvolvimento \\ \textbf{Grupo 17}\\ Problema 3
       } %Titulo do documento
%\title{Um Exemplo de Artigo em \LaTeX}
\author{José Pedro Gomes Ferreira\\ A91636 \\  \and Pedro Paulo Costa Pereira\\ A88062
         \and Tiago André Oliveira Leite\\ A91693
       } %autores do documento
\date{\today} %data

\begin{document} % corpo do documento
\maketitle % apresentar titulo, autor e data


\tableofcontents % Insere a tabela de indice
%\listoffigures % Insere a tabela de indice figuras
%\listoftables % Insere a tabela de indice tabelas


%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo1%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%


\chapter{Introdução} \label{chap:intro} %referência cruzada

Neste documento vamos explicar a solução que implementamos para a resolução do probelma proposto no ambito da unidade curricular de Processsamento de Linguagens e Compiladores. \\
O problema proposto consiste em analisar o ficheiro de texto $calv$-$users.txt$ e atraves da utilização da linguagem Python e da biblioteca de expressões regulares 're' extrair informação de forma a produzir alguns resultados.\\No desenvolvimento do programa procuramos utilizar o conhecimento adquirido nas aulas, esperando por isso que o resultado final cumpra todos os requisitos. 


%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo2%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%



\chapter{Problema Proposto} \label{chap:ProbelemaProposto} %capitulo e referencia cruzada

\section{Descrição} \label{sec:Descricao} %seccao e referencia cruzada
Construa um ou vários programas
para processar o texto ' clav-users.txt ' em que campos de informação
têm a seguinte ordem: nome, email, entidade, nível, número de chamadas ao backend, com o intuito de calcular alguns
resultados conforme solicitado a seguir:
\begin{itemize}
\item Produz uma listagem apenas com o nome e a entidade do utilizador, ordenada alfabeticamente por nome;
\item Produz uma lista ordenada alfabeticamente das entidades referenciadas, indicando, para cada uma, quantos utilizadores estão registados;
\item Qual a distribuição de utilizadores por níveis de acesso?
\item Produz uma listagem dos utilizadores, agrupados por entidade, ordenada primeiro pela entidade e dentro desta pelo nome;
\item Por fim, produz os seguintes indicadores:
\begin{enumerate}[1.]
\item Quantos utilizadores?
\item Quantas entidades?
\item Qual a distribuição em número por entidade?
\item Qual a distribuição em número por nível?
\end{enumerate}
\end{itemize}
Para terminar, deve imprimir os 20 primeiros registos num novo ficheiro de output mas em formato Json .

\section{Requisitos} \label{sec:Requesitos}
\begin{itemize}
  \item Utilização da linguagem Python.
  \item Resolver o problema com uso de expressoes regulares.
  \item Utilizar o modulo 're'.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo3%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%

\chapter{Concepção/desenho da Resolução}
\section{Organização}
Por forma a tornar a resolução do trabalho mais simples, decidimos criar uma função especifica para resolver cada uma das alineas do problema. Assim sendo, a solução do problema vai ser composta por 6 funções mais uma que vai servir de menu para o utilizador poder escolher qual das funcionalidades do prograna quer utilizar.\\
Na execução do programa todas as linhas do ficheiro 'clav-users.txt' são lidas para uma variavel que depois será utlizada por cada uma da funções.\\
Por uma questão de simplicidade, sempre que for necessário ordenar, a ordem utilizada é a a ordem alfabética \\
No codigo do programa decidimos colocar as expressões regulares utilizadas como variaveis globais de forma a que seja mais facíl, no futuro, melhorar o programa. No entanto, na descrição das implemetações que faremos de seguida optamos por escrever as expressões regulares utilizadas em cada função.

\section{Funcionalidades}
Todas as funções descritas neste capítulo podem ser encontradas no anexo A do documento.
\subsection{Executar o programa.}
Para executar o programa o utilizador terá que colocar na mesma diretoria os ficheiro 'main.py' e o ficheiro de input. De seguida basta abrir o terminal nessa diretoria e exceutar o comando:
\begin{verbatim}
>> python3 main.py <ficheiro de input>
\end{verbatim}
Caso o utilizador execute o comando:
\begin{verbatim}
>> python3 main.py 
\end{verbatim}
o programa, por defeito, vai tentar abrir e ler o ficheiro 'clav-users.txt'
\subsection{O menu.}
O menu do programa é implementado pela função \verb menu() . \\
Esta função cria um ciclo \verb while \ que mostra ao utilizador todas as opções de funcionalidades disponiveis. De seguida lê a opção escolhida pelo utilizador e caso a opção esteja entre 1 e 6 vai invocar a função que implementa a funcionalidade selecionada. Se a opção escolhida pelo utilizador for menor que 0 ou maior que 6 vai ser mostrada uma mensagem de erro  sendo solicitado ao  utilizador que escolha novamente. Caso a opção seja 0, o programa termina a sua execução.\\
Para tornar a experiencia mais agradavel aos olhos, entre a execução de cada funcionalidade, é feita uma limpeza do ecrã atravês da impressão de 50 paragrafos. 

\subsection{Nome dos utilizadores ordenados e respetiva entidade.}
Esta funcionalidade é implementada pela função \verb name_entity_list() . \\
Na sua implementação vamos iterar por cada linha do texto e em cada uma vamos procurar o nome de utilizador e a entidade correspondente. Para capturar o nome do utlizador vamos utilizar a função \verb re.match \ com a expressão regular \verb '(\w+\.?\s*(-?\w+\.?\s*)*\b)' \ e para capturar a entidade utilizamos a função \verb re.search \ com a expressão regular \verb 'ent_\w*' . De seguida armazenamos o resultado num dicionario em que a chave é o nome do utilizador e o valor é uma lista com as entindades desse utilizador. Caso o utilizador ainda nao exista no dicionario é criada uma nova entrada, caso contrario, a entidade capturada é acrescentada na lista do utilizador. \\ 
Por fim, transformamos o dicionario numa lista composta pelos pares (nome de utilizador, entidade(s)), ordenada por nome de utilizador, e fazemos a impresão de cada utilizador e respetiva(s) entidade(s).\\ \\
\textbf{Nota:} Na implementação desta função decidimos diferenciar utilizadores cujo nome apenas difere no facto de as letras estarem em maiusculas ou minusculas. Por exemplo 'xxxx', 'XXXX' e 'Xxxx' são  utilizadores distintos.

\subsection{Entidades ordenadas e número de utilizadores registados em cada uma.}
Esta funcionalidade é implementada pela função \verb entity_num_elements_list() . \\
Na sua implementação vamos iterar por cada linha do texto e através da função \verb re.search \ com a expressão regular \verb 'ent_\w*'  \ vamos capturar a entidade presente nessa linha. A entidade capturada é armazenada num dicionario cuja chave é o nome da entidade e o valor é o numero de utilizadores nessa entidade. Caso a entidade ainda não exista no dicionario  é criada uma nova entrada com o valor 1, caso contrario, o valor dessa entidade no dicionario é incrementado em 1. \\
Por fim, transformamos o dicionario numa lista composta pelos pares (entidade, nº de utilizadores), ordenada por entidade, e fazemos a impresão de cada entidade e respetivo nº de utilizadores. \\ \\
\textbf{Nota:} Na implementação desta função decidimos diferenciar utilizadores cujo nome apenas difere no facto de as letras estarem em maiusculas ou minusculas. Por exemplo 'xxxx', 'XXXX' e 'Xxxx' são  utilizadores distintos.

\subsection{Distribuiçao dos utilizadores por nível de acesso.}
Esta funcionalidade é implementada pela função \verb dist_users_level() . \\
Na sua implementação vamos iterar por cada linha do texto e partir cada uma destas pelo separador \verb '[:,|]+' \ com o uso da função \verb re.split . De seguida vamos capturar o nome de utilizador no primeiro elemento (index 0) da linha partida com a função \verb re.match \ e a expressão regular \verb '(\w+\.?\s*(-?\w+\.?\s*)*\b)' \ e vamos capturar o nível de acesso no quarto elemento da linha partida (index 3) com a função \verb re.search \ e a expressão regular \verb '\d+\.?\d*' . O resultado de capturar o nível de acesso e nome de utilizador são armazenados num dicionário em que a chave  é o nível de acesso e o valor é um conjunto com os utilizadores com esse nível de acesso. Optamos por um conjunto para evitar repetições, uma vez que existem utilizadores com mais do que um nível de acesso. Caso o nível de acesso capturado nao exista no dicionario, é criada uma entrada cuja chave é o nível de acesso e cujo valor é um conjunto com o utilizador capturado, caso contrario, o utilizador é acrescentado ao conjunto de utilizadores ja existente para aquela chave. Para ser mais facil de contar o nº de utilizadores total utilizamos tambem um conjunto onde vamos colocando cada utilizador capturado.\\
Por fim, transformamos o dicionario numa lista composta pelos pares (nível de acesso, utilizadores) ordenada por nível de acesso e fazemos uma impressão dos utilizadores presentes em cada nível de acesso assim como a percentagem de utilizadores por nível. \\ \\
\textbf{Nota:} Na implementação desta função decidimos diferenciar utilizadores cujo nome apenas difere no facto de as letras estarem em maiusculas ou minusculas. Por exemplo 'xxxx', 'XXXX' e 'Xxxx' são  utilizadores distintos.


\subsection{Utilizadores agrupados por entidade, ordenados por nome e entidade.}
Esta funcionalidade é implementada pela função \verb name_entity_group() . \\
Na sua implementação vamos iterar por cada linha do texto e em cada uma vamos procurar o nome de utilizador e a entidade correspondente. Para capturar o nome do utlizador vamos utilizar a função \verb re.match \ com a expressão regular \verb '(\w+\.?\s*(-?\w+\.?\s*)*\b)' \ e para capturar a entidade utilizamos a função \verb re.search \ com a expressão regular \verb 'ent_\w*' .
De seguida armazenamos o resultado num dicionario em que a chave é a entidade e o valor é uma lista com os utilizadores dessa entidade. Caso a entidade ainda nao exista no dicionario é criada uma nova entrada, caso contrario, o utilizadore capturado é acrescentada na lista da entidade. \\ 
Por fim, transformamos o dicionario numa lista composta pelos pares (entidade, utilizador), ordenada por entidade, e fazemos a impresão de cada entidade e respetivos utilizadores ordenados por nome.\\ \\
\textbf{Nota:} Na implementação desta função decidimos diferenciar utilizadores cujo nome apenas difere no facto de as letras estarem em maiusculas ou minusculas. Por exemplo 'xxxx', 'XXXX' e 'Xxxx' são  utilizadores distintos.


\subsection{Mostrar alguns indicadores.}
Esta funcionalidade é implementada pela função \verb indicators() . \\
Na sua implementação vamos iterar por cada linha do texto e partir cada uma destas pelo separador \verb '[:,|]+' \ com o uso da função \verb re.split . De seguida vamos capturar o nome de utilizador no primeiro elemento (index 0) da linha partida com a função \verb re.match \ e a expressão regular \verb '(\w+\.?\s*(-?\w+\.?\s*)*\b)' \,vamos capturar a entidade no terceiro elemento da linha partida (index 2) com a função \verb re.search \ e a expressão regular \verb 'ent_\w*' , e  vamos capturar o nível de acesso no quarto elemento da linha partida (index 3) com a função \verb re.search \ e a expressão regular \verb '\d+\.?\d*' . Os nomes de utilizadores capturados anteriormente são armazenados num conjunto, para evitar repetiçoes, enquanto que as entidades e níveis de acesso capturados anteriormente são armazenados em dois dicionarios. Num dos dicionarios o par chaves e valores são a entidade e respetivo número de utilizadores enquanto que no outro o par chave e valores são o nível de acesso e respetivo número de utilizadores. \\
Por fim, fazemos um impressão do número total de utilizadores, o número total de entidades, o número de utilizadores por entidade e o número de utilizadores por nível de acesso. \\ \\
\textbf{Nota:} Na implementação desta função decidimos diferenciar utilizadores cujo nome apenas difere no facto de as letras estarem em maiusculas ou minusculas. Por exemplo 'xxxx', 'XXXX' e 'Xxxx' são  utilizadores distintos.  

\subsection{Imprimir num ficheiro Json os 20 primeiros registos.}
Esta funcionalidade é implementada pela função \verb json_20() . \\
Na sua implementação vamos iterar por cada umas das 20 primeiras linhas do texto e partir cada uma destas pelo separador \verb '[:,|]+' \ com o uso da função \verb re.split . De seguida vamos capturar o nome de utilizador no primeiro elemento (index 0) da linha partida com a função \verb re.match \ e a expressão regular \verb '(\w+\.?\s*(-?\w+\.?\s*)*\b)' , vamos capturar o email de utilizador no segundo elemento (index 1) da linha partida com a função \verb re.search \ e a expressão regular \verb '(\w+|\.|@|_|-)+'  , vamos capturar a entidade no terceiro elemento da linha partida (index 2) com a função \verb re.search \ e a expressão regular \verb 'ent_\w*' , vamos capturar o nível de acesso no quarto elemento da linha partida (index 3) com a função \verb re.search \ e a expressão regular \verb '\d+\.?\d*' , e vamos capturar o número de chamadas ao backend no quinto elemento da linha partida (index 4) com a função \verb re.search \ e a expressão regular \verb '\d+' . O resultado de cada linha é armazenado numa lista de tuplos (node de utilizador, email, entidade, nível de acesso, número de chamadas ao backend).  \\
Finalizadas as capturas pedimos ao utilizador para escolher qual o nome do ficheiro para o qual quer imprimir os dados recolhidos. Depois abrimos o fichero e procedemos à impressão de cada registo (tuplo armazenado na lista) num formato json. \\ \\
\textbf{Nota:} Caso o ficheiro não possua 20 linhas, a função vai iterar por todas as linhas existentes no texto e apresentar os registos encontrados. \\


%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo4%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%

\chapter{Demonstração de Funcionamento}
\section{Ficheiro: 'clav-users'}
\subsection{Conteúdo do ficheiro.}

\begin{verbatim}
Élia Cristina Viegas Pedro :: epedro@ccdr-alg.pt :: ent_CCDR-Alg :: 1 :: 0
Formação DGLAB :: lurdes.almeida@dglab.gov.pt :: ent_DGLAB :: 3.5 :: 0
Nuno Filipe Casas Novas :: nuno.novas@ccdr-lvt.pt :: ent_CCDR-LVT :: 1 :: 0
Sónia Patrícia Pinheiro Reis :: sonia.reis@icnf.pt :: ent_ICNF :: 1 :: 0
Sónia Isabel Ferreira Gonçalves Negrão :: sonia.negrao@cm-albufeira.pt :: ent_CMABF :: 1 :: 0
Filipe Ferreira Cardoso Leitão :: arquivo@cm-spsul.pt :: ent_CMSPS :: 1 :: 0
Ana Lúcia Cabrita Guerreiro :: alucia@ccdr-alg.pt :: ent_CCDR-Alg :: 1 :: 0
Alda do Carmo Namora Soares de Andrade :: aandrade@letras.ulisboa.pt :: ent_FLUL :: 1 :: 0
Ricardo Almeida :: ricardo.almeida@dgeg.gov.pt :: ent_DGEG :: 1 :: 0
Sandra Cristina Patrício da Silva :: spatricio@mun-sines.pt :: ent_CMSNS :: 1 :: 0
Cátia João Matias Trindade :: catia.trindade@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
Ricardo Canela :: tyty@tyty.pt :: ent_BdP :: 3 :: 0
Cátia Trindade :: matiasjcatia@gmail.com :: ent_DGLAB :: 4 :: 0
Miguel Ferreira :: mferreira@keep.pt :: ent_KEEP :: 7 :: 0
Fernando Manuel Antunes Marques da Silva :: fernando.marques.silva@marinha.pt :: ent_STI-M :: 1 :: 0
Ana Maria Teixeira Gaspar :: ana.gaspar@sgmf.gov.pt :: ent_SGMF :: 1 :: 0
Maria Matos de Almeida Talhada Correia :: MariaMatos.Correia@icnf.pt :: ent_ICNF :: 1 :: 0
Cármen Isabel Amador Francisco :: carmem@mun-sines.pt :: ent_CMSNS :: 1 :: 0
Maria Leonor da Conceição Fresco Franco :: leonor.mina@ccdr-lvt.pt :: ent_CCDR-LVT :: 1 :: 0
Maria Rita Gago :: m-rita.gago@dglab.gov.pt :: ent_DGLAB :: 6 :: 3
José Carlos Leite Ramalho :: jcr@di.uminho.pt :: ent_A3ES :: 7 :: 3
Regina Neves Lopes :: Regina.Lopes@sgmf.gov.pt :: ent_SGMF :: 1 :: 0
João Paulo de Melo Esteves Pereira :: joao.pereira@apambiente.pt :: ent_APA :: 1 :: 0
António José Morim Brandão :: Antonio.brandao@metrodoporto.pt :: ent_MdP :: 1 :: 0
Alexandra Lourenço :: alexandra.lourenco@dglab.gov.pt :: ent_DGLAB :: 7 :: 3
Rui Araújo :: pg38425@alunos.uminho.pt :: ent_II :: 7 :: 9
Filipa Carvalho :: filipa.carvalho@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
clara cristina rainho viegas :: clara.viegas@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
Madalena Ribeiro :: madalena.ribeiro@dglab.gov.pt :: ent_DGLAB :: 6 :: 0
Zélia Gomes :: zelia.gomes@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
Frederico Pinto :: frederico21pinto@hotmail.com :: ent_ACSS :: 7 :: 0
Pedro Penteado :: pedro.penteado@dglab.gov.pt :: ent_DGLAB :: 5 :: 1
Madalena Ribeiro :: madalena.ribeiro07@gmail.com :: ent_DGLAB :: 4 :: 2
Alexandre Teixeira :: a73547@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
octavio :: octaviojmaia@gmail.com :: ent_A3ES :: 2 :: 0
José Carlos Martins :: a78821@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
Silvestre Lacerda :: silvestre.lacerda@dglab.gov.pt :: ent_DGLAB :: 5 :: 0
Design-DGLAB :: a75536@alunos.uminho.pt :: ent_DGLAB :: 7 :: 0
João Pimentel :: A80874@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
Maria Celeste Pereira :: m-celeste.pereira@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
CLAV-migrator :: a74036@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
Alexadre Teixeira :: alex@keep.pt :: ent_KEEP :: 7 :: 0
Carlos Barbosa :: A82324@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
Rui Araújo Simples :: 0.rffa.0@gmail.com :: ent_LNEC :: 1 :: 0
Manuel Monteiro :: a74036@alunos.uminhopt :: ent_A3ES :: 7 :: 0
Rui Araújo Entidade :: ruifilipearaujo@hotmail.com :: ent_AAN :: 1 :: 0
Duarte Freitas :: a63129@alunos.uminho.pt :: ent_A3ES :: 7 :: 0
Maria José Maciel Chaves :: m-jose.chaves@dglab.gov.pt :: ent_DGLAB :: 4 :: 0
jcm :: jcm@live.com :: ent_AAN :: 1 :: 0
José Carlos Leite Ramalho :: jcr@dglab.pt :: ent_DGLAB :: 7 :: 0
Alexandra Testes :: m-alexandra.lourenco@dglab.gov.pt :: ent_A3ES :: 1 :: 0
Paulo Lima :: plima@keep.pt :: ent_KEEP :: 7 :: 0
Alexandra Maria Alves Coutinho Rodrigues :: acoutinh@utad.pt :: ent_UTAD :: 1 :: 0
Aluno de DAW2020 :: leo.ramalho99@gmail.com :: ent_A3ES :: 2 :: 0
PRI2020-teste :: pri2020@teste.uminho.pt :: ent_A3ES :: 2 :: 0
DAW2020-teste :: daw2020@teste.uminho.pt :: ent_A3ES :: 2 :: 0
jcr-rep-entidade :: zzglider@gmail.com :: ent_A3ES :: 1 :: 0
Carlos Matoso :: cmatoso@ambisig.com :: ent_IEFP :: 2 :: 0
Joana Braga :: jbraga@ambisig.com :: ent_IEFP :: 2 :: 0
David Ferreira :: david.ferreira@ambisig.com :: ent_IEFP :: 2 :: 0
\end{verbatim}


\subsection{Execução e menu.}
\begin{small}
\begin{verbatim}
>> python3 main.py clav-users.txt

*** Selecione Opção ***

1. Listagem com o nome e a entidade do utilizador, ordenada alfabeticamente por nome.
2. Lista ordenada alfabeticamente das entidades referenciadas, indicando, para cada uma, quantos utilizadores estão registados.
3. Distribuição de utilizadores por níveis de acesso.
4. Utilizadores, agrupados por entidade, ordenada primeiro pela entidade e dentro desta pelo nome.
5. Mostrar alguns indicadores.
6. Imprimir os 20 primeiros registos num novo ficheiro de output mas em formato jason.
0. Sair.
>> 
\end{verbatim}
\end{small}

\subsection{Nome dos utilizadores ordenados e respetiva entidade.}

\begin{verbatim}
>> 1

*** Utilizador : Entidade(s) ***

Alda do Carmo Namora Soares de Andrade : ent_FLUL
Alexadre Teixeira : ent_KEEP
Alexandra Lourenço : ent_DGLAB
Alexandra Maria Alves Coutinho Rodrigues : ent_UTAD
Alexandra Testes : ent_A3ES
Alexandre Teixeira : ent_A3ES
Aluno de DAW2020 : ent_A3ES
Ana Lúcia Cabrita Guerreiro : ent_CCDR
Ana Maria Teixeira Gaspar : ent_SGMF
António José Morim Brandão : ent_MdP
Carlos Barbosa : ent_A3ES
Carlos Matoso : ent_IEFP
Cármen Isabel Amador Francisco : ent_CMSNS
Cátia João Matias Trindade : ent_DGLAB
Cátia Trindade : ent_DGLAB
clara cristina rainho viegas : ent_DGLAB
CLAV-migrator : ent_A3ES
David Ferreira : ent_IEFP
DAW2020-teste : ent_A3ES
Design-DGLAB : ent_DGLAB
Duarte Freitas : ent_A3ES
Élia Cristina Viegas Pedro : ent_CCDR
Fernando Manuel Antunes Marques da Silva : ent_STI
Filipa Carvalho : ent_DGLAB
Filipe Ferreira Cardoso Leitão : ent_CMSPS
Formação DGLAB : ent_DGLAB
Frederico Pinto : ent_ACSS
jcm : ent_AAN
jcr-rep-entidade : ent_A3ES
Joana Braga : ent_IEFP
João Paulo de Melo Esteves Pereira : ent_APA
João Pimentel : ent_A3ES
José Carlos Leite Ramalho : ent_A3ES, ent_DGLAB
José Carlos Martins : ent_A3ES
Madalena Ribeiro : ent_DGLAB, ent_DGLAB
Manuel Monteiro : ent_A3ES
Maria Celeste Pereira : ent_DGLAB
Maria José Maciel Chaves : ent_DGLAB
Maria Leonor da Conceição Fresco Franco : ent_CCDR
Maria Matos de Almeida Talhada Correia : ent_ICNF
Maria Rita Gago : ent_DGLAB
Miguel Ferreira : ent_KEEP
Nuno Filipe Casas Novas : ent_CCDR
octavio : ent_A3ES
Paulo Lima : ent_KEEP
Pedro Penteado : ent_DGLAB
PRI2020-teste : ent_A3ES
Regina Neves Lopes : ent_SGMF
Ricardo Almeida : ent_DGEG
Ricardo Canela : ent_BdP
Rui Araújo : ent_II
Rui Araújo Entidade : ent_AAN
Rui Araújo Simples : ent_LNEC
Sandra Cristina Patrício da Silva : ent_CMSNS
Silvestre Lacerda : ent_DGLAB
Sónia Isabel Ferreira Gonçalves Negrão : ent_CMABF
Sónia Patrícia Pinheiro Reis : ent_ICNF
Zélia Gomes : ent_DGLAB

Pressione Enter!
>> 
\end{verbatim}


\subsection{Entidades ordenadas e número de utilizadores registados em cada uma.}

\begin{verbatim}
>> 2

*** Entidade : Nº Utilizadores ***

ent_A3ES : 14
ent_AAN : 2
ent_ACSS : 1
ent_APA : 1
ent_BdP : 1
ent_CCDR : 4
ent_CMABF : 1
ent_CMSNS : 2
ent_CMSPS : 1
ent_DGEG : 1
ent_DGLAB : 16
ent_FLUL : 1
ent_ICNF : 2
ent_IEFP : 3
ent_II : 1
ent_KEEP : 3
ent_LNEC : 1
ent_MdP : 1
ent_SGMF : 2
ent_STI : 1
ent_UTAD : 1

Pressione Enter!
>> 
\end{verbatim}



\subsection{Distribuiçao dos utilizadores por nível de acesso.}

\begin{verbatim}
>> 3

*** Nível de Acesso : Distribuição ***

Nível 1 : 40%
* Alda do Carmo Namora Soares de Andrade
* Alexandra Maria Alves Coutinho Rodrigues
* Alexandra Testes
* Ana Lúcia Cabrita Guerreiro
* Ana Maria Teixeira Gaspar
* António José Morim Brandão
* Cármen Isabel Amador Francisco
* Élia Cristina Viegas Pedro
* Fernando Manuel Antunes Marques da Silva
* Filipe Ferreira Cardoso Leitão
* jcm
* jcr-rep-entidade
* João Paulo de Melo Esteves Pereira
* Maria Leonor da Conceição Fresco Franco
* Maria Matos de Almeida Talhada Correia
* Nuno Filipe Casas Novas
* Regina Neves Lopes
* Ricardo Almeida
* Rui Araújo Entidade
* Rui Araújo Simples
* Sandra Cristina Patrício da Silva
* Sónia Isabel Ferreira Gonçalves Negrão
* Sónia Patrícia Pinheiro Reis

Nível 2 : 12%
* Aluno de DAW2020
* Carlos Matoso
* David Ferreira
* DAW2020-teste
* Joana Braga
* octavio
* PRI2020-teste

Nível 3 : 2%
* Ricardo Canela

Nível 3.5 : 2%
* Formação DGLAB

Nível 4 : 14%
* Cátia João Matias Trindade
* Cátia Trindade
* clara cristina rainho viegas
* Filipa Carvalho
* Madalena Ribeiro
* Maria Celeste Pereira
* Maria José Maciel Chaves
* Zélia Gomes

Nível 5 : 3%
* Pedro Penteado
* Silvestre Lacerda

Nível 6 : 3%
* Madalena Ribeiro
* Maria Rita Gago

Nível 7 : 26%
* Alexadre Teixeira
* Alexandra Lourenço
* Alexandre Teixeira
* Carlos Barbosa
* CLAV-migrator
* Design-DGLAB
* Duarte Freitas
* Frederico Pinto
* João Pimentel
* José Carlos Leite Ramalho
* José Carlos Martins
* Manuel Monteiro
* Miguel Ferreira
* Paulo Lima
* Rui Araújo

Pressione Enter!
>>  
\end{verbatim}


\subsection{Utilizadores agrupados por entidade, ordenados por nome e entidade.}

\begin{verbatim}
>> 4

*** Utilizadores agrupados por entidade ***

ent_A3ES:
* Alexandra Testes
* Alexandre Teixeira
* Aluno de DAW2020
* Carlos Barbosa
* CLAV-migrator
* DAW2020-teste
* Duarte Freitas
* jcr-rep-entidade
* João Pimentel
* José Carlos Leite Ramalho
* José Carlos Martins
* Manuel Monteiro
* octavio
* PRI2020-teste

ent_AAN:
* jcm
* Rui Araújo Entidade

ent_ACSS:
* Frederico Pinto

ent_APA:
* João Paulo de Melo Esteves Pereira

ent_BdP:
* Ricardo Canela

ent_CCDR:
* Ana Lúcia Cabrita Guerreiro
* Élia Cristina Viegas Pedro
* Maria Leonor da Conceição Fresco Franco
* Nuno Filipe Casas Novas

ent_CMABF:
* Sónia Isabel Ferreira Gonçalves Negrão

ent_CMSNS:
* Cármen Isabel Amador Francisco
* Sandra Cristina Patrício da Silva

ent_CMSPS:
* Filipe Ferreira Cardoso Leitão

ent_DGEG:
* Ricardo Almeida

ent_DGLAB:
* Alexandra Lourenço
* Cátia João Matias Trindade
* Cátia Trindade
* clara cristina rainho viegas
* Design-DGLAB
* Filipa Carvalho
* Formação DGLAB
* José Carlos Leite Ramalho
* Madalena Ribeiro
* Madalena Ribeiro
* Maria Celeste Pereira
* Maria José Maciel Chaves
* Maria Rita Gago
* Pedro Penteado
* Silvestre Lacerda
* Zélia Gomes

ent_FLUL:
* Alda do Carmo Namora Soares de Andrade

ent_ICNF:
* Maria Matos de Almeida Talhada Correia
* Sónia Patrícia Pinheiro Reis

ent_IEFP:
* Carlos Matoso
* David Ferreira
* Joana Braga

ent_II:
* Rui Araújo

ent_KEEP:
* Alexadre Teixeira
* Miguel Ferreira
* Paulo Lima

ent_LNEC:
* Rui Araújo Simples

ent_MdP:
* António José Morim Brandão

ent_SGMF:
* Ana Maria Teixeira Gaspar
* Regina Neves Lopes

ent_STI:
* Fernando Manuel Antunes Marques da Silva

ent_UTAD:
* Alexandra Maria Alves Coutinho Rodrigues


Pressione Enter!
>> 
\end{verbatim}



\subsection{Mostrar alguns indicadores.}

\begin{verbatim}
>> 5

*** Indicadores ***

Número de Utilizadores: 58

Número de Entidades: 21

Distribuição de utilizadores por entidade:
* ent_A3ES : 14
* ent_AAN : 2
* ent_ACSS : 1
* ent_APA : 1
* ent_BdP : 1
* ent_CCDR : 4
* ent_CMABF : 1
* ent_CMSNS : 2
* ent_CMSPS : 1
* ent_DGEG : 1
* ent_DGLAB : 16
* ent_FLUL : 1
* ent_ICNF : 2
* ent_IEFP : 3
* ent_II : 1
* ent_KEEP : 3
* ent_LNEC : 1
* ent_MdP : 1
* ent_SGMF : 2
* ent_STI : 1
* ent_UTAD : 1

Distribuição de utilizadores por nível:
* Nível 1 : 23
* Nível 2 : 7
* Nível 3 : 1
* Nível 3.5 : 1
* Nível 4 : 8
* Nível 5 : 2
* Nível 6 : 2
* Nível 7 : 16

Pressione Enter!
>> 
\end{verbatim}



\subsection{Imprimir num ficheiro Json os 20 primeiros registos.}

\begin{verbatim}
>> 6   

Digite nome do ficheiro de output!
>> json.txt

Ficheiro "json.txt" gerado com sucesso!

Pressione Enter!
>> 
\end{verbatim}

\textbf{Conteúdo do ficheiro json.txt}

\begin{verbatim}
{
  "registos":[
    {
       "utilizador":"Élia Cristina Viegas Pedro",
       "email":"epedro@ccdr-alg.pt",
       "entidade":"ent_CCDR",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Formação DGLAB",
       "email":"lurdes.almeida@dglab.gov.pt",
       "entidade":"ent_DGLAB",
       "nível de acesso":"3.5",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Nuno Filipe Casas Novas",
       "email":"nuno.novas@ccdr-lvt.pt",
       "entidade":"ent_CCDR",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Sónia Patrícia Pinheiro Reis",
       "email":"sonia.reis@icnf.pt",
       "entidade":"ent_ICNF",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Sónia Isabel Ferreira Gonçalves Negrão",
       "email":"sonia.negrao@cm-albufeira.pt",
       "entidade":"ent_CMABF",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Filipe Ferreira Cardoso Leitão",
       "email":"arquivo@cm-spsul.pt",
       "entidade":"ent_CMSPS",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Ana Lúcia Cabrita Guerreiro",
       "email":"alucia@ccdr-alg.pt",
       "entidade":"ent_CCDR",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Alda do Carmo Namora Soares de Andrade",
       "email":"aandrade@letras.ulisboa.pt",
       "entidade":"ent_FLUL",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Ricardo Almeida",
       "email":"ricardo.almeida@dgeg.gov.pt",
       "entidade":"ent_DGEG",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Sandra Cristina Patrício da Silva",
       "email":"spatricio@mun-sines.pt",
       "entidade":"ent_CMSNS",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Cátia João Matias Trindade",
       "email":"catia.trindade@dglab.gov.pt",
       "entidade":"ent_DGLAB",
       "nível de acesso":"4",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Ricardo Canela",
       "email":"tyty@tyty.pt",
       "entidade":"ent_BdP",
       "nível de acesso":"3",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Cátia Trindade",
       "email":"matiasjcatia@gmail.com",
       "entidade":"ent_DGLAB",
       "nível de acesso":"4",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Miguel Ferreira",
       "email":"mferreira@keep.pt",
       "entidade":"ent_KEEP",
       "nível de acesso":"7",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Fernando Manuel Antunes Marques da Silva",
       "email":"fernando.marques.silva@marinha.pt",
       "entidade":"ent_STI",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Ana Maria Teixeira Gaspar",
       "email":"ana.gaspar@sgmf.gov.pt",
       "entidade":"ent_SGMF",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Maria Matos de Almeida Talhada Correia",
       "email":"MariaMatos.Correia@icnf.pt",
       "entidade":"ent_ICNF",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Cármen Isabel Amador Francisco",
       "email":"carmem@mun-sines.pt",
       "entidade":"ent_CMSNS",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Maria Leonor da Conceição Fresco Franco",
       "email":"leonor.mina@ccdr-lvt.pt",
       "entidade":"ent_CCDR",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Maria Rita Gago",
       "email":"m-rita.gago@dglab.gov.pt",
       "entidade":"ent_DGLAB",
       "nível de acesso":"6",
       "número de chamadas ao backend":"3"
    }
  ]
}

\end{verbatim}


\section{Ficheiro: 'forum-online.txt'}
\subsection{Conteúdo do ficheiro.}

\begin{verbatim}
Pedro Penedo da Rocha Calhau , parte_pedra@gmail.com , ent_op , 1 , 5
Engenheiro Socrates , animal_feroz@yahoo.pt, ent_dr, 3, 2
Professor Marcelo, marselfie@hotmail.com, ent_dr, 2, 2
CR7, cristianinho@hotmail.com, ent_fig, 7, 7
Eng. Fernando Santos, mete_mais_um_trinco@protonmail.com , ent_fig, 3, 10
Xico Esperto, o.xico.esperto@protonmail.com, ent_op, 4 ,  7
Dona Dolores , mae_coragem@yahoo.com, ent_fig, 2, 7
Dr. R. Salgado, ddt@protonmail.com, ent_dr, 2, 30
Jacinto Leite Capelo Rego, jacintorego@outlook.pt, ent_op, 2, 4
Passos Dias Aguiar Mota, pdamota@gmail.com, ent_op, 8, 2
JJ, peaners@hotmail.com, ent_fig, 3, 88
Zé Povinho, zezinho@gmail.com, ent_op, 2, 0
Inacio, naosejasinacio@hotmail.com, ent_fig, 4, 2
Geremias, geremeias666@yahoo.pt, ent_op, 4, 3
registado777, registado777@gmail.com, ent_op, 2, 1
ativista, a.t.i.v.i.s.t.a@hotmail.com, ent_fig, 2, 3  
\end{verbatim}


\subsection{Execução e menu.}
\begin{small}
\begin{verbatim}
>> python3 main.py forum-online.txt

*** Selecione Opção ***

1. Listagem com o nome e a entidade do utilizador, ordenada alfabeticamente por nome.
2. Lista ordenada alfabeticamente das entidades referenciadas, indicando, para cada uma, quantos utilizadores estão registados.
3. Distribuição de utilizadores por níveis de acesso.
4. Utilizadores, agrupados por entidade, ordenada primeiro pela entidade e dentro desta pelo nome.
5. Mostrar alguns indicadores.
6. Imprimir os 20 primeiros registos num novo ficheiro de output mas em formato jason.
0. Sair.
>> 
\end{verbatim}
\end{small}

\subsection{Nome dos utilizadores ordenados e respetiva entidade.}

\begin{verbatim}
>> 1

*** Utilizador : Entidade(s) ***

ativista : ent_fig
CR7 : ent_fig
Dona Dolores : ent_fig
Dr. R. Salgado : ent_dr
Eng. Fernando Santos : ent_fig
Engenheiro Socrates : ent_dr
Geremias : ent_op
Inacio : ent_fig
Jacinto Leite Capelo Rego : ent_op
JJ : ent_fig
Passos Dias Aguiar Mota : ent_op
Pedro Penedo da Rocha Calhau : ent_op
Professor Marcelo : ent_dr
registado777 : ent_op
Xico Esperto : ent_op
Zé Povinho : ent_op

Pressione Enter!
>> 
\end{verbatim}


\subsection{Entidades ordenadas e número de utilizadores registados em cada uma.}

\begin{verbatim}
>> 2

*** Entidade : Nº Utilizadores ***

ent_dr : 3
ent_fig : 6
ent_op : 7

Pressione Enter!
>> 
\end{verbatim}



\subsection{Distribuiçao dos utilizadores por nível de acesso.}

\begin{verbatim}
>> 3

*** Nível de Acesso : Distribuição ***

Nível 1 : 6%
* Pedro Penedo da Rocha Calhau

Nível 2 : 44%
* ativista
* Dona Dolores
* Dr. R. Salgado
* Jacinto Leite Capelo Rego
* Professor Marcelo
* registado777
* Zé Povinho

Nível 3 : 19%
* Eng. Fernando Santos
* Engenheiro Socrates
* JJ

Nível 4 : 19%
* Geremias
* Inacio
* Xico Esperto

Nível 7 : 6%
* CR7

Nível 8 : 6%
* Passos Dias Aguiar Mota

Pressione Enter!
>> 
\end{verbatim}


\subsection{Utilizadores agrupados por entidade, ordenados por nome e entidade.}

\begin{verbatim}
>> 4

*** Utilizadores agrupados por entidade ***

ent_dr:
* Dr. R. Salgado
* Engenheiro Socrates
* Professor Marcelo

ent_fig:
* ativista
* CR7
* Dona Dolores
* Eng. Fernando Santos
* Inacio
* JJ

ent_op:
* Geremias
* Jacinto Leite Capelo Rego
* Passos Dias Aguiar Mota
* Pedro Penedo da Rocha Calhau
* registado777
* Xico Esperto
* Zé Povinho


Pressione Enter!
>> 
\end{verbatim}



\subsection{Mostrar alguns indicadores.}

\begin{verbatim}
>> 5

*** Indicadores ***

Número de Utilizadores: 16

Número de Entidades: 3

Distribuição de utilizadores por entidade:
* ent_dr : 3
* ent_fig : 6
* ent_op : 7

Distribuição de utilizadores por nível:
* Nível 1 : 1
* Nível 2 : 7
* Nível 3 : 3
* Nível 4 : 3
* Nível 7 : 1
* Nível 8 : 1

Pressione Enter!
>> 
\end{verbatim}



\subsection{Imprimir num ficheiro Json os 20 primeiros registos.}

\begin{verbatim}
>> 6

Digite nome do ficheiro de output!
>> json.txt

Ficheiro "json.txt" gerado com sucesso!

Pressione Enter!
>> 
\end{verbatim}

\textbf{Conteúdo do ficheiro json.txt}

\begin{verbatim}
{
  "registos":[
    {
       "utilizador":"Pedro Penedo da Rocha Calhau",
       "email":"parte_pedra@gmail.com",
       "entidade":"ent_op",
       "nível de acesso":"1",
       "número de chamadas ao backend":"5"
    },
    {
       "utilizador":"Engenheiro Socrates",
       "email":"animal_feroz@yahoo.pt",
       "entidade":"ent_dr",
       "nível de acesso":"3",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"Professor Marcelo",
       "email":"marselfie@hotmail.com",
       "entidade":"ent_dr",
       "nível de acesso":"2",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"CR7",
       "email":"cristianinho@hotmail.com",
       "entidade":"ent_fig",
       "nível de acesso":"7",
       "número de chamadas ao backend":"7"
    },
    {
       "utilizador":"Eng. Fernando Santos",
       "email":"mete_mais_um_trinco@protonmail.com",
       "entidade":"ent_fig",
       "nível de acesso":"3",
       "número de chamadas ao backend":"10"
    },
    {
       "utilizador":"Xico Esperto",
       "email":"o.xico.esperto@protonmail.com",
       "entidade":"ent_op",
       "nível de acesso":"4",
       "número de chamadas ao backend":"7"
    },
    {
       "utilizador":"Dona Dolores",
       "email":"mae_coragem@yahoo.com",
       "entidade":"ent_fig",
       "nível de acesso":"2",
       "número de chamadas ao backend":"7"
    },
    {
       "utilizador":"Dr. R. Salgado",
       "email":"ddt@protonmail.com",
       "entidade":"ent_dr",
       "nível de acesso":"2",
       "número de chamadas ao backend":"30"
    },
    {
       "utilizador":"Jacinto Leite Capelo Rego",
       "email":"jacintorego@outlook.pt",
       "entidade":"ent_op",
       "nível de acesso":"2",
       "número de chamadas ao backend":"4"
    },
    {
       "utilizador":"Passos Dias Aguiar Mota",
       "email":"pdamota@gmail.com",
       "entidade":"ent_op",
       "nível de acesso":"8",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"JJ",
       "email":"peaners@hotmail.com",
       "entidade":"ent_fig",
       "nível de acesso":"3",
       "número de chamadas ao backend":"88"
    },
    {
       "utilizador":"Zé Povinho",
       "email":"zezinho@gmail.com",
       "entidade":"ent_op",
       "nível de acesso":"2",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Inacio",
       "email":"naosejasinacio@hotmail.com",
       "entidade":"ent_fig",
       "nível de acesso":"4",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"Geremias",
       "email":"geremeias666@yahoo.pt",
       "entidade":"ent_op",
       "nível de acesso":"4",
       "número de chamadas ao backend":"3"
    },
    {
       "utilizador":"registado777",
       "email":"registado777@gmail.com",
       "entidade":"ent_op",
       "nível de acesso":"2",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"ativista",
       "email":"a.t.i.v.i.s.t.a@hotmail.com",
       "entidade":"ent_fig",
       "nível de acesso":"2",
       "número de chamadas ao backend":"3"
    },
  ]
}
\end{verbatim}

\section{Ficheiro: 'plc2021.txt'}
\subsection{Conteúdo do ficheiro.}

\begin{verbatim}
Anabela Pereira | a87990@alunos.uminho.pt | ent_G12 | 1 | 0
André Filipe Oliveira Araújo | a87987@alunos.uminho.pt | ent_G09 | 1 | 0
André Gonçalves | a87942@alunos.uminho.pt | ent_G12 | 1 | 0
André Oliveira Boechat Morandi | a86912@alunos.uminho.pt | ent_G14 | 1 | 1
André Ribeiro Fernandes | a87938@alunos.uminho.pt | ent_G01 | 1 | 0
Aureo Bendito | a76068@alunos.uminho.pt | ent_G18 | 1 | 0
Bruna Alvarães | a84729@alunos.uminho.pt | ent_G07 | 1 | 2
Bruna Dias Carvalho | a87982@alunos.uminho.pt | ent_G15 | 1 | 0
Bruna Gonçalves Araújo | a84408@alunos.uminho.pt | ent_G02 | 1 | 0
Bruno Alexandre Dias Novais de Sousa | a84945@alunos.uminho.pt | ent_G05 | 1 | 1
Bruno Miguel Pinheiro Alves | a85481@alunos.uminho.pt | ent_G17 | 1 | 0
Carlos Henrique Senra Ferreira | a87953@alunos.uminho.pt | ent_G08 | 1 | 1
Daniel André Rocha Ribeiro | a87994@alunos.uminho.pt | ent_G08 | 1 | 2
Daniel Martins Carvalho Ferreira | a85670@alunos.uminho.pt | ent_G02 | 1 | 0
David Ferreira | a80673@alunos.uminho.pt | ent_G19 | 2 | 1
David Silvestre Ölund Matos | a87997@alunos.uminho.pt | ent_G03 | 1 | 1
Diogo Costa Fernandes | a87968@alunos.uminho.pt | ent_G04 | 1 | 1
Diogo Sambento | a87965@alunos.uminho.pt | ent_G16 | 1 | 1
Eduardo Luis Vieira Pereira | a87965@alunos.uminho.pt | ent_G00 | 1 | 0
Fernando Augusto Marques Lobo | a87988@alunos.uminho.pt | ent_G04 | 1 | 0
Filipe Matias Antas Viana | a85948@alunos.uminho.pt | ent_G13 | 1 | 1
Francisco Domingos Martins Oliveira | a82066@alunos.uminho.pt | ent_G13 | 1 | 3
Gil Miguel da Mota Marques | a84076@alunos.uminho.pt | ent_G19 | 2 | 1
Gilberto Rui Nogueira Cunha | a89142@alunos.uminho.pt | ent_G06 | 2 | 1
Guilherme Santos | a85115@alunos.uminho.pt | ent_G07 | 1 | 1
Hélder Cristiano Lopes | a87951@alunos.uminho.pt | ent_G14 | 1 | 2
João Carlos Viana Pereira Marques | a84684@alunos.uminho.pt | ent_G17 | 1 | 1
João Diogo Torres Cardosa da Silva | a87939@alunos.uminho.pt | ent_G20 | 1 | 0
João Domingos Pereira Barbosa | a82044@alunos.uminho.pt | ent_G20 | 1 | 0
João Guilherme Reis | a84671@alunos.uminho.pt | ent_G21 | 1 | 1
João Manuel Silva Antunes | a81663@alunos.uminho.pt | ent_G13 | 1 | 0
João Pedro Antunes | a86813@alunos.uminho.pt | ent_G10 | 1 | 3
João Pedro Duarte Coutinho | a83545@alunos.uminho.pt | ent_G00 | 1 | 1
João Pedro Oliveira Correia | a87945@alunos.uminho.pt | ent_G03 | 1 | 1
Jorge André Vieira Freitas | a87944@alunos.uminho.pt | ent_G03 | 1 | 0
José Luís Antunes Martins | a75583@alunos.uminho.pt | ent_G19 | 2 | 1
José Luís Cerqueira Pires | a84552@alunos.uminho.pt | ent_G11 | 1 | 0
José Manuel Neves C.L. Machado | a87979@alunos.uminho.pt | ent_G01 | 1 | 2
Luís Almeida | a84180@alunos.uminho.pt | ent_G10 | 1 | 1
Luís Miguel Rodrigues Guimarães | a87947@alunos.uminho.pt | ent_G04 | 1 | 1
Márcia Filipa da Cruz Cerqueira | a87992@alunos.uminho.pt | ent_G11 | 1 | 0
Márlon Daniel Duarte Ferreira | a81735@alunos.uminho.pt | ent_G15 | 1 | 1
Paulo Ricardo Dias da Costa | a87986@alunos.uminho.pt | ent_G09 | 1 | 1
Pedro Beir | a80656@alunos.uminho.pt | ent_G18 | 1 | 1
Pedro Henrique Costa | a87959@alunos.uminho.pt | ent_G16 | 1 | 1
Pedro Miguel Martins | a87964@alunos.uminho.pt | ent_G16 | 1 | 1
Ricardo Nuno de Castro Cruz | a86789@alunos.uminho.pt | ent_G02 | 1 | 0
Rui Filipe Traila de Sousa | a85908@alunos.uminho.pt | ent_G21 | 1 | 3
Rui Jorge de Oliveira Faria | a87957@alunos.uminho.pt | ent_G01 | 1 | 1
Rui Miguel Pimenta e Cunha | a85877@alunos.uminho.pt | ent_G05 | 1 | 2
Tomás Barros Carneiro | a82552@alunos.uminho.pt | ent_G06 | 2 | 3
Tomás Salazar Valente | a85172@alunos.uminho.pt | ent_G00 | 1 | 1
\end{verbatim}


\subsection{Execução e menu.}
\begin{small}
\begin{verbatim}
>> python3 main.py plc2021.txt

*** Selecione Opção ***

1. Listagem com o nome e a entidade do utilizador, ordenada alfabeticamente por nome.
2. Lista ordenada alfabeticamente das entidades referenciadas, indicando, para cada uma, quantos utilizadores estão registados.
3. Distribuição de utilizadores por níveis de acesso.
4. Utilizadores, agrupados por entidade, ordenada primeiro pela entidade e dentro desta pelo nome.
5. Mostrar alguns indicadores.
6. Imprimir os 20 primeiros registos num novo ficheiro de output mas em formato jason.
0. Sair.
>> 
\end{verbatim}
\end{small}

\subsection{Nome dos utilizadores ordenados e respetiva entidade.}

\begin{verbatim}
>> 1

*** Utilizador : Entidade(s) ***

Anabela Pereira : ent_G12
André Filipe Oliveira Araújo : ent_G09
André Gonçalves : ent_G12
André Oliveira Boechat Morandi : ent_G14
André Ribeiro Fernandes : ent_G01
Aureo Bendito : ent_G18
Bruna Alvarães : ent_G07
Bruna Dias Carvalho : ent_G15
Bruna Gonçalves Araújo : ent_G02
Bruno Alexandre Dias Novais de Sousa : ent_G05
Bruno Miguel Pinheiro Alves : ent_G17
Carlos Henrique Senra Ferreira : ent_G08
Daniel André Rocha Ribeiro : ent_G08
Daniel Martins Carvalho Ferreira : ent_G02
David Ferreira : ent_G19
David Silvestre Ölund Matos : ent_G03
Diogo Costa Fernandes : ent_G04
Diogo Sambento : ent_G16
Eduardo Luis Vieira Pereira : ent_G00
Fernando Augusto Marques Lobo : ent_G04
Filipe Matias Antas Viana : ent_G13
Francisco Domingos Martins Oliveira : ent_G13
Gil Miguel da Mota Marques : ent_G19
Gilberto Rui Nogueira Cunha : ent_G06
Guilherme Santos : ent_G07
Hélder Cristiano Lopes : ent_G14
João Carlos Viana Pereira Marques : ent_G17
João Diogo Torres Cardosa da Silva : ent_G20
João Domingos Pereira Barbosa : ent_G20
João Guilherme Reis : ent_G21
João Manuel Silva Antunes : ent_G13
João Pedro Antunes : ent_G10
João Pedro Duarte Coutinho : ent_G00
João Pedro Oliveira Correia : ent_G03
Jorge André Vieira Freitas : ent_G03
José Luís Antunes Martins : ent_G19
José Luís Cerqueira Pires : ent_G11
José Manuel Neves C.L. Machado : ent_G01
Luís Almeida : ent_G10
Luís Miguel Rodrigues Guimarães : ent_G04
Márcia Filipa da Cruz Cerqueira : ent_G11
Márlon Daniel Duarte Ferreira : ent_G15
Paulo Ricardo Dias da Costa : ent_G09
Pedro Beir : ent_G18
Pedro Henrique Costa : ent_G16
Pedro Miguel Martins : ent_G16
Ricardo Nuno de Castro Cruz : ent_G02
Rui Filipe Traila de Sousa : ent_G21
Rui Jorge de Oliveira Faria : ent_G01
Rui Miguel Pimenta e Cunha : ent_G05
Tomás Barros Carneiro : ent_G06
Tomás Salazar Valente : ent_G00

Pressione Enter!
>> 
\end{verbatim}


\subsection{Entidades ordenadas e número de utilizadores registados em cada uma.}

\begin{verbatim}
>> 2

*** Entidade : Nº Utilizadores ***

ent_G00 : 3
ent_G01 : 3
ent_G02 : 3
ent_G03 : 3
ent_G04 : 3
ent_G05 : 2
ent_G06 : 2
ent_G07 : 2
ent_G08 : 2
ent_G09 : 2
ent_G10 : 2
ent_G11 : 2
ent_G12 : 2
ent_G13 : 3
ent_G14 : 2
ent_G15 : 2
ent_G16 : 3
ent_G17 : 2
ent_G18 : 2
ent_G19 : 3
ent_G20 : 2
ent_G21 : 2

Pressione Enter!
>> 
\end{verbatim}



\subsection{Distribuiçao dos utilizadores por nível de acesso.}

\begin{verbatim}
>> 3

*** Nível de Acesso : Distribuição ***

Nível 1 : 90%
* Anabela Pereira
* André Filipe Oliveira Araújo
* André Gonçalves
* André Oliveira Boechat Morandi
* André Ribeiro Fernandes
* Aureo Bendito
* Bruna Alvarães
* Bruna Dias Carvalho
* Bruna Gonçalves Araújo
* Bruno Alexandre Dias Novais de Sousa
* Bruno Miguel Pinheiro Alves
* Carlos Henrique Senra Ferreira
* Daniel André Rocha Ribeiro
* Daniel Martins Carvalho Ferreira
* David Silvestre Ölund Matos
* Diogo Costa Fernandes
* Diogo Sambento
* Eduardo Luis Vieira Pereira
* Fernando Augusto Marques Lobo
* Filipe Matias Antas Viana
* Francisco Domingos Martins Oliveira
* Guilherme Santos
* Hélder Cristiano Lopes
* João Carlos Viana Pereira Marques
* João Diogo Torres Cardosa da Silva
* João Domingos Pereira Barbosa
* João Guilherme Reis
* João Manuel Silva Antunes
* João Pedro Antunes
* João Pedro Duarte Coutinho
* João Pedro Oliveira Correia
* Jorge André Vieira Freitas
* José Luís Cerqueira Pires
* José Manuel Neves C.L. Machado
* Luís Almeida
* Luís Miguel Rodrigues Guimarães
* Márcia Filipa da Cruz Cerqueira
* Márlon Daniel Duarte Ferreira
* Paulo Ricardo Dias da Costa
* Pedro Beir
* Pedro Henrique Costa
* Pedro Miguel Martins
* Ricardo Nuno de Castro Cruz
* Rui Filipe Traila de Sousa
* Rui Jorge de Oliveira Faria
* Rui Miguel Pimenta e Cunha
* Tomás Salazar Valente

Nível 2 : 10%
* David Ferreira
* Gil Miguel da Mota Marques
* Gilberto Rui Nogueira Cunha
* José Luís Antunes Martins
* Tomás Barros Carneiro

Pressione Enter!
>>  
\end{verbatim}


\subsection{Utilizadores agrupados por entidade, ordenados por nome e entidade.}

\begin{verbatim}
>> 4

*** Utilizadores agrupados por entidade ***

ent_G00:
* Eduardo Luis Vieira Pereira
* João Pedro Duarte Coutinho
* Tomás Salazar Valente

ent_G01:
* André Ribeiro Fernandes
* José Manuel Neves C.L. Machado
* Rui Jorge de Oliveira Faria

ent_G02:
* Bruna Gonçalves Araújo
* Daniel Martins Carvalho Ferreira
* Ricardo Nuno de Castro Cruz

ent_G03:
* David Silvestre Ölund Matos
* João Pedro Oliveira Correia
* Jorge André Vieira Freitas

ent_G04:
* Diogo Costa Fernandes
* Fernando Augusto Marques Lobo
* Luís Miguel Rodrigues Guimarães

ent_G05:
* Bruno Alexandre Dias Novais de Sousa
* Rui Miguel Pimenta e Cunha

ent_G06:
* Gilberto Rui Nogueira Cunha
* Tomás Barros Carneiro

ent_G07:
* Bruna Alvarães
* Guilherme Santos

ent_G08:
* Carlos Henrique Senra Ferreira
* Daniel André Rocha Ribeiro

ent_G09:
* André Filipe Oliveira Araújo
* Paulo Ricardo Dias da Costa

ent_G10:
* João Pedro Antunes
* Luís Almeida

ent_G11:
* José Luís Cerqueira Pires
* Márcia Filipa da Cruz Cerqueira

ent_G12:
* Anabela Pereira
* André Gonçalves

ent_G13:
* Filipe Matias Antas Viana
* Francisco Domingos Martins Oliveira
* João Manuel Silva Antunes

ent_G14:
* André Oliveira Boechat Morandi
* Hélder Cristiano Lopes

ent_G15:
* Bruna Dias Carvalho
* Márlon Daniel Duarte Ferreira

ent_G16:
* Diogo Sambento
* Pedro Henrique Costa
* Pedro Miguel Martins

ent_G17:
* Bruno Miguel Pinheiro Alves
* João Carlos Viana Pereira Marques

ent_G18:
* Aureo Bendito
* Pedro Beir

ent_G19:
* David Ferreira
* Gil Miguel da Mota Marques
* José Luís Antunes Martins

ent_G20:
* João Diogo Torres Cardosa da Silva
* João Domingos Pereira Barbosa

ent_G21:
* João Guilherme Reis
* Rui Filipe Traila de Sousa


Pressione Enter!
>> 
\end{verbatim}



\subsection{Mostrar alguns indicadores.}

\begin{verbatim}
>> 5

*** Indicadores ***

Número de Utilizadores: 52

Número de Entidades: 22

Distribuição de utilizadores por entidade:
* ent_G00 : 3
* ent_G01 : 3
* ent_G02 : 3
* ent_G03 : 3
* ent_G04 : 3
* ent_G05 : 2
* ent_G06 : 2
* ent_G07 : 2
* ent_G08 : 2
* ent_G09 : 2
* ent_G10 : 2
* ent_G11 : 2
* ent_G12 : 2
* ent_G13 : 3
* ent_G14 : 2
* ent_G15 : 2
* ent_G16 : 3
* ent_G17 : 2
* ent_G18 : 2
* ent_G19 : 3
* ent_G20 : 2
* ent_G21 : 2

Distribuição de utilizadores por nível:
* Nível 1 : 47
* Nível 2 : 5

Pressione Enter!
>>
\end{verbatim}



\subsection{Imprimir num ficheiro Json os 20 primeiros registos.}

\begin{verbatim}
>> 6   

Digite nome do ficheiro de output!
>> json.txt

Ficheiro "json.txt" gerado com sucesso!

Pressione Enter!
>> 
\end{verbatim}

\textbf{Conteúdo do ficheiro json.txt}

\begin{verbatim}
{
  "registos":[
    {
       "utilizador":"Anabela Pereira",
       "email":"a87990@alunos.uminho.pt",
       "entidade":"ent_G12",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"André Filipe Oliveira Araújo",
       "email":"a87987@alunos.uminho.pt",
       "entidade":"ent_G09",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"André Gonçalves",
       "email":"a87942@alunos.uminho.pt",
       "entidade":"ent_G12",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"André Oliveira Boechat Morandi",
       "email":"a86912@alunos.uminho.pt",
       "entidade":"ent_G14",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"André Ribeiro Fernandes",
       "email":"a87938@alunos.uminho.pt",
       "entidade":"ent_G01",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Aureo Bendito",
       "email":"a76068@alunos.uminho.pt",
       "entidade":"ent_G18",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Bruna Alvarães",
       "email":"a84729@alunos.uminho.pt",
       "entidade":"ent_G07",
       "nível de acesso":"1",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"Bruna Dias Carvalho",
       "email":"a87982@alunos.uminho.pt",
       "entidade":"ent_G15",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Bruna Gonçalves Araújo",
       "email":"a84408@alunos.uminho.pt",
       "entidade":"ent_G02",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Bruno Alexandre Dias Novais de Sousa",
       "email":"a84945@alunos.uminho.pt",
       "entidade":"ent_G05",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"Bruno Miguel Pinheiro Alves",
       "email":"a85481@alunos.uminho.pt",
       "entidade":"ent_G17",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Carlos Henrique Senra Ferreira",
       "email":"a87953@alunos.uminho.pt",
       "entidade":"ent_G08",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"Daniel André Rocha Ribeiro",
       "email":"a87994@alunos.uminho.pt",
       "entidade":"ent_G08",
       "nível de acesso":"1",
       "número de chamadas ao backend":"2"
    },
    {
       "utilizador":"Daniel Martins Carvalho Ferreira",
       "email":"a85670@alunos.uminho.pt",
       "entidade":"ent_G02",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"David Ferreira",
       "email":"a80673@alunos.uminho.pt",
       "entidade":"ent_G19",
       "nível de acesso":"2",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"David Silvestre Ölund Matos",
       "email":"a87997@alunos.uminho.pt",
       "entidade":"ent_G03",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"Diogo Costa Fernandes",
       "email":"a87968@alunos.uminho.pt",
       "entidade":"ent_G04",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"Diogo Sambento",
       "email":"a87965@alunos.uminho.pt",
       "entidade":"ent_G16",
       "nível de acesso":"1",
       "número de chamadas ao backend":"1"
    },
    {
       "utilizador":"Eduardo Luis Vieira Pereira",
       "email":"a87965@alunos.uminho.pt",
       "entidade":"ent_G00",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    },
    {
       "utilizador":"Fernando Augusto Marques Lobo",
       "email":"a87988@alunos.uminho.pt",
       "entidade":"ent_G04",
       "nível de acesso":"1",
       "número de chamadas ao backend":"0"
    }
  ]
}
\end{verbatim}






%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo5%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%

\chapter{Conclusão} \label{concl}
Com o projeto concluído esperamos ter cumprido todos os requisitos que nos foram propostos e que o nosso programa respeite os princípios da disciplina.
Numa primeira aborgagem tentanto fazer a captura dos nomes de utilizador com a função \verb findAll , no entanto não esta a ser muito facil obter resultados por causa do inicio de linha, pelo que optamos por em todos os exercios iterar linha a linha.
No problema que nos foi proposto, em cada uma das alineas é nos pedido que façamos um programa, no entanto achamos que a utilização do menu, na qual podemos escolher qual a funcionaliadade, torna a experiencia do utilizador mais simples e agradavel.
Todos concordamos que o facto de o projecto ter sido desenvolvido na linguagem 'Python' e com recuso à biblioteca 're', facilitou bastante a sua implementação.

%%%%%%%%%%%%%%%%%%%%%%
%%%%%Capitulo6%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%

\appendix % apendice
\chapter{Código do Programa}

\textbf{Ficheiro main.py}

\begin{verbatim}
import re
import unidecode
import sys
import os.path


def name_entity_list():
    result = {}
    for line in text:
        user =  re.match(user_er,line).group()
        entity = re.search(entity_er,line).group()
        if user not in result:
            result[user] = [entity]
        else:
            result[user].append(', ')
            result[user].append(entity)
    result = list(result.items())
    result.sort(key=lambda x: unidecode.unidecode(x[0].casefold()))
    print("\n*** Utilizador : Entidade(s) ***\n")
    for r in result:
        print(r[0], ":", "".join(r[1]))


def entity_num_elements_list():
    entities = {}
    for line in text:
        entity = re.search(entity_er, line).group()
        if entity not in entities:
            entities[entity] = 1
        else:
            entities[entity] +=1

    result = list(entities.items())
    result.sort()
    print("\n*** Entidade : Nº Utilizadores ***\n")
    for r in result:
        print(r[0], ":", r[1])


def dist_users_level():
    levels = {}
    users = set()
    for line in text:
        broken_line = re.split(separator_er, line)
        user = re.match(user_er, broken_line[0]).group()
        level = re.search(level_er,broken_line[3]).group()
        if level not in levels:
            levels[level] = set()
            levels[level].add(user)
        else:
            levels[level].add(user)
        users.add(user)
    result = list(levels.items())
    result.sort()
    total_users = len(users)
    print("\n*** Nível de Acesso : Distribuição ***\n")
    for r in result:
        print(f"Nível {r[0]} : {round((len(r[1])/total_users)*100)}%" )
        for user in sorted(r[1], key=lambda x: unidecode.unidecode(x.casefold())):
            print("*",user)
        if(result.index(r) != len(result)-1):
            print("")


def name_entity_group():
    result = {}
    for line in text:
        user = re.match(user_er, line).group()
        entity = re.search(entity_er, line).group()
        if entity not in result:
            result[entity] = [user]
        else:
            result[entity].append(user)

    entities = list(result.keys())
    entities.sort()
    print("\n*** Utilizadores agrupados por entidade ***\n")
    for entity in entities:
        print(f"{entity}:")
        result[entity].sort(key=lambda x: unidecode.unidecode(x.casefold()))
        for user in result[entity]:
            print("*",user)
        print("")


def indicators():
    users = set()
    entities = {}
    levels = {}
    for line in text:
        broken_line = re.split(r'[:,|]+', line)
        users.add(re.match(user_er,broken_line[0]).group())
        entity = re.search(entity_er, broken_line[2]).group()
        level = re.search(level_er, broken_line[3]).group()

        if entity not in entities:
            entities[entity] = 1
        else:
            entities[entity] += 1
        if level not in levels:
            levels[level] = 1
        else:
            levels[level] += 1

    print("\n*** Indicadores ***\n")
    print("Número de Utilizadores:",len(users))
    print("")
    print("Número de Entidades:",len(entities.keys()))
    print("")
    print("Distribuição de utilizadores por entidade:")
    for entity in sorted(entities.keys()):
        print(f"* {entity} : {entities[entity]}")
    print("")
    print("Distribuição de utilizadores por nível:")
    for level in sorted(levels.keys()):
        print(f"* Nível {level} : {levels[level]}")


def json_20():
    list = []
    N = len(text)
    if N >= 20:
        N = 20

    for i in range(N):
        broken_line = re.split(separator_er, text[i])
        user = re.match(user_er, broken_line[0]).group()
        email = re.search(email_er, broken_line[1]).group()
        entity = re.search(entity_er, broken_line[2]).group()
        level = re.search(level_er, broken_line[3]).group()
        calls = re.search(calls_er, broken_line[4]).group()
        list.append((user,email,entity,level,calls))

    file_name = input("\nDigite nome do ficheiro de output!\n>> ")
    fp = open(file_name, 'w')

    fp.write("{\n\t\"registos\":[\n")
    for i in range(len(list)):
        l = list[i]
        fp.write("\t\t{\n")
        fp.write(f"\t\t\t \"utilizador\":\"{l[0]}\",\n")
        fp.write(f"\t\t\t \"email\":\"{l[1]}\",\n")
        fp.write(f"\t\t\t \"entidade\":\"{l[2]}\",\n")
        fp.write(f"\t\t\t \"nível de acesso\":\"{l[3]}\",\n")
        fp.write(f"\t\t\t \"número de chamadas ao backend\":\"{l[4]}\"\n")
        if i != 19:
            fp.write("\t\t},\n")
        else:
            fp.write("\t\t}\n")
    fp.write("\t]\n}\n")
    fp.close()
    print(f"\nFicheiro \"{file_name}\" gerado com sucesso!")


def menu():
    cls = lambda: print('\n' * 50)
    inputfromuser = ""
    options = []
    options.append("Listagem com o nome e a entidade do utilizador, ordenada alfabeticamente por nome.")
    options.append("Lista ordenada alfabeticamente das entidades referenciadas, indicando, para cada uma, quantos utilizadores estão registados.")
    options.append("Distribuição de utilizadores por níveis de acesso.")
    options.append("Utilizadores, agrupados por entidade, ordenada primeiro pela entidade e dentro desta pelo nome.")
    options.append("Mostrar alguns indicadores.")
    options.append("Imprimir os 20 primeiros registos num novo ficheiro de output mas em formato jason.")
    cls()
    while inputfromuser != '0':
        print("*** Selecione Opção ***\n")
        for i in range(len(options)):
            print(f"{i+1}. {options[i]}")
        print("0. Sair.")

        inputfromuser = input(">> ")
        while not inputfromuser.isdigit() or int(inputfromuser) > len(options) or int(inputfromuser) < 0:
            print("Opçao Invalida!")
            inputfromuser = input(">> ")

        if inputfromuser == '0':
            continue
        elif inputfromuser == '1':
            name_entity_list()
        elif inputfromuser == '2':
            entity_num_elements_list()
        elif inputfromuser == '3':
            dist_users_level()
        elif inputfromuser == '4':
            name_entity_group()
        elif inputfromuser == '5':
            indicators()
        else:
            json_20()

        input("\nPressione Enter!\n>> ")
        cls()


if len(sys.argv)>1:
    text_source = sys.argv[1]
else:
    text_source = 'clav-users.txt'

if not os.path.exists(text_source):
    print(f"Ficheiro \"{text_source}\" não encontrado!")
    sys.exit(0)

fp = open(text_source, 'r')
text = fp.readlines()
fp.close()

calls_er = r'\d+'
entity_er = r'ent_\w*'
email_er = r'(\w+|\.|@|_|-)+'
level_er = r'\d+\.?\d*'
separator_er = r'[:,|]+'
user_er = r'(\w+\.?\s*(-?\w+\.?\s*)*\b)'

menu()
\end{verbatim}




\lstinputlisting[caption={Exemplo de uma importação}, label={lstExe2}]{listagemImportadaLayout.l} %input de um ficheiro da listagem

%-- Fim do documento -- inserção das referencias bibliográficas

%\bibliographystyle{plain} % [1] Numérico pela ordem de citação ou ordem alfabetica
\bibliographystyle{alpha} % [Hen18] abreviação do apelido e data da publicação
%\bibliographystyle{apalike} % (Araujo, 2018) apelido e data da publicação
                             % --para usar este estilo descomente no inicio o comando \usepackage{apalike}

\bibliography{bibLayout} %input do ficheiro de referencias bibliograficas

\end{document} 